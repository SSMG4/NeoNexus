<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="*" Name="NeoNexus" Language="1033" Version="0.1.0.0" Manufacturer="SSMG4" UpgradeCode="b8f3a2c1-4d9e-4b6f-9c2a-1e3d5f7a8b9c">
    <Package InstallerVersion="500" Compressed="yes" InstallScope="perMachine" />

    <!-- Removed unsupported AllowDowngrade attribute to be compatible with WiX 3.x on the runner -->
    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />

    <MediaTemplate />

    <!-- Install files from dotnet publish output (win-x64 publish folder).
         Paths are relative to this file's directory (Windows/installer/wix).
    -->
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="INSTALLFOLDER" Name="NeoNexus" />
      </Directory>
    </Directory>

    <DirectoryRef Id="INSTALLFOLDER">
      <Component Id="cmpNeoNexusExe" Guid="*">
        <File Id="fileNeoNexusExe" Source="..\..\win\NeoNexus.WinDemo\bin\Release\net8.0-windows\win-x64\publish\NeoNexus.WinDemo.exe" KeyPath="yes" />
      </Component>

      <Component Id="cmpNeoNexusNative" Guid="*">
        <File Id="fileNeoNexusNative" Source="..\..\native\build\bin\NeoNexusNative.dll" KeyPath="yes" />
      </Component>
    </DirectoryRef>

    <Feature Id="ProductFeature" Title="NeoNexus" Level="1">
      <ComponentRef Id="cmpNeoNexusExe" />
      <ComponentRef Id="cmpNeoNexusNative" />
    </Feature>
  </Product>
</Wix>
